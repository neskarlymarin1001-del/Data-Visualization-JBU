---
title: "LAB4.2: Penn World Table (Time Series)"
author: "Neskarly Marin"
format:
  revealjs:
    embed-resources: true
    theme: serif
    slide-number: true
    chalkboard: false
    transition: fade
    code-fold: true
    code-line-numbers: false
    center: false
    width: 1200
    height: 675
    scrollable: true
    code-overflow: wrap
execute:
  echo: true
  warning: false
  message: false
knitr:
  opts_chunk:
    dev: "svg"
---


```{r}
#| include: false

library(tidyverse)
library(scales)

load("pwt_data.RData")

theme_set(
  theme_minimal(base_size = 16) +
    theme(
      plot.title = element_text(face = "bold"),
      plot.subtitle = element_text(color = "gray30"),
      panel.grid.minor = element_blank(),
      legend.title = element_text(face = "bold"),
      legend.position = "top"
    )
)

highlight_blue <- "#1A73E8"
muted_gray <- "#B0B4B9"

```

## Chart 1 — GDP per capita growth across economies 
### RQ: How do GDP per capita trends differ across advanced and emerging economies from 1970 to 2019?

- *Chart choice:* Multi-line time series for comparing trends across a small set of countries; log scale improves comparability when levels differ greatly.

```{r}
#| code-fold: true
#| output-location: slide

focus_countries <- c("United States", "Germany", "China", "India")

pwt_data %>%
  filter(country %in% focus_countries) %>%
  ggplot(aes(x = year, y = GDPperCap, color = country)) +
  geom_line(linewidth = 1.2) +
  scale_y_log10(labels = dollar_format()) +
  scale_x_continuous(breaks = seq(1970, 2019, by = 10)) +
  labs(
    title = "GDP per Capita Growth Across Economies (1970–2019)",
    subtitle = "Log scale highlights proportional growth and long-run convergence patterns across countries.",
    x = "Year",
    y = "GDP per Capita (log scale)",
    color = "Country"
  )

```

## Chart 2 — Human capital trends 
### RQ: How has human capital changed over time across selected countries, and do improvement patterns look similar?

- *Chart choice:* Faceted time-series charts avoid clutter and make country-by-country comparisons easy.

```{r}
#| code-fold: true
#| output-location: slide

focus_countries <- c("United States", "Germany", "China", "India")

pwt_data %>%
  filter(country %in% focus_countries) %>%
  ggplot(aes(x = year, y = HumanCapitalIndex)) +
  geom_line(linewidth = 1.2, color = highlight_blue) +
  geom_vline(xintercept = 2008, linewidth = 0.7, color = muted_gray) +
  facet_wrap(~country, ncol = 2, scales = "fixed") +
  scale_x_continuous(breaks = seq(1970, 2019, by = 10)) +
  labs(
    title = "Human Capital Index Over Time (1970–2019)",
    subtitle = "All four countries show steady gains; the 2008 marker provides context for a shock period.",
    x = "Year",
    y = "Human Capital Index"
  )

```


