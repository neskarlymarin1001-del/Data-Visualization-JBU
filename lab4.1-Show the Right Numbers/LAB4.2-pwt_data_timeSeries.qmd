---
title: "LAB4.2: Penn World Table (Time Series)"
author: "Neskarly Marin"
format:
  revealjs:
    embed-resources: true
    theme: serif
    slide-number: true
    chalkboard: false
    transition: fade
    code-fold: true
    code-line-numbers: false
    center: false
    width: 1200
    height: 675
    scrollable: true
    code-overflow: wrap
execute:
  echo: true
  warning: false
  message: false
knitr:
  opts_chunk:
    dev: "svg"
---


```{r}
#| include: false

library(tidyverse)
library(scales)

load("pwt_data.RData")

theme_set(
  theme_minimal(base_size = 16) +
    theme(
      plot.title = element_text(face = "bold"),
      plot.subtitle = element_text(color = "gray30"),
      panel.grid.minor = element_blank(),
      legend.title = element_text(face = "bold"),
      legend.position = "top"
    )
)

highlight_blue <- "#1A73E8"
muted_gray <- "#B0B4B9"

```

## Chart 1 — GDP per capita growth across economies 
### <span style="color:#1A73E8;">RQ: How do GDP per capita trends differ across advanced and emerging economies from 1970 to 2019?:</span>

- *Chart choice:* Multi-line time series for comparing trends across a small set of countries; log scale improves comparability when levels differ greatly.

```{r}
#| code-fold: true
#| code-summary: "Show code for Chart 1"
#| eval: false

focus_countries <- c("United States", "Germany", "China", "India")

pwt_data %>%
  filter(country %in% focus_countries) %>%
  ggplot(aes(x = year, y = GDPperCap, color = country)) +
  geom_line(linewidth = 1.2) +
  scale_y_log10(labels = dollar_format()) +
  scale_x_continuous(breaks = seq(1970, 2019, by = 10)) +
  labs(
    title = "GDP per Capita Growth Across Economies (1970–2019)",
    subtitle = "Log scale highlights proportional growth and long-run convergence patterns.",
    x = "Year",
    y = "GDP per Capita (log scale)",
    color = "Country"
  )

```

## Chart 1 — GDP per capita growth across economies 

::: {.columns}

::: {.column width="68%"}

```{r}
#| echo: false
#| fig-width: 9
#| fig-height: 4.8

focus_countries <- c("United States", "Germany", "China", "India")

pal_gdp <- c(
  "United States" = "#6A5ACD",  # muted purple
  "Germany" = "#2E8B57",        # deep green
  "China" = "#1A73E8",          # your signature blue
  "India" = "#E76F51"           # muted coral
)

pwt_data %>%
  filter(country %in% focus_countries) %>%
  mutate(country = factor(country, levels = focus_countries)) %>%
  ggplot(aes(x = year, y = GDPperCap, color = country)) +
  geom_line(linewidth = 1.3) +
  scale_color_manual(values = pal_gdp) +
  scale_y_log10(labels = label_dollar(scale_cut = cut_short_scale())) +
  scale_x_continuous(breaks = seq(1970, 2019, by = 10)) +
  labs(
    title = "GDP per Capita Growth Across Economies (1970–2019)",
    subtitle = "China shows the fastest proportional growth.",
    x = "Year",
    y = "GDP per Capita (log scale)",
    color = "Country"
  ) +
  guides(color = guide_legend(override.aes = list(linewidth = 3)))
```

:::

::: {.column width="32%"}

<div style="font-size:0.65em; line-height:1.15; margin-top: 1.5em;">

**Key Insights**

- The United States and Germany maintain the highest GDP per capita.

- China shows the fastest proportional growth.

- India also grows steadily but remains below.

- The gap narrows over time, suggesting partial convergence among countries.

</div>
:::
:::

## Chart 2 — Human capital trends 
### <span style="color:#1A73E8;">RQ: How has human capital changed over time across selected countries, and do improvement patterns look similar?:</span>

- *Chart choice:* Faceted time-series charts avoid clutter and make country-by-country comparisons easy.

```{r}
#| code-fold: true
#| code-summary: "Show code for Chart 2"
#| eval: false

focus_countries <- c("United States", "Germany", "China", "India")

pwt_data %>%
  filter(country %in% focus_countries) %>%
  ggplot(aes(x = year, y = HumanCapitalIndex)) +
  geom_line(linewidth = 1.2, color = highlight_blue) +
  geom_vline(xintercept = 2008, linewidth = 0.7, color = muted_gray) +
  facet_wrap(~country, ncol = 2, scales = "fixed") +
  scale_x_continuous(breaks = seq(1970, 2019, by = 10)) +
  labs(
    title = "Human Capital Index Over Time (1970–2019)",
    subtitle = "All four countries show steady gains; the 2008 marker provides context for a shock period.",
    x = "Year",
    y = "Human Capital Index"
  )

```

## Chart 2 — Human capital trends 

::: {.columns}

::: {.column width="68%"}

```{r}
#| echo: false
#| fig-width: 9
#| fig-height: 4.8

focus_countries <- c("United States", "Germany", "China", "India")

pwt_data %>%
  filter(country %in% focus_countries) %>%
  ggplot(aes(x = year, y = HumanCapitalIndex)) +
  geom_line(linewidth = 1.2, color = highlight_blue) +
  geom_vline(xintercept = 2008, linewidth = 0.7, color = muted_gray) +
  facet_wrap(~country, ncol = 2, scales = "fixed", strip.position = "top") +
  scale_x_continuous(breaks = seq(1970, 2019, by = 10)) +
  labs(
    title = "Human Capital Index Over Time (1970–2019)",
    subtitle = "There are faster gains in emerging economies",
    x = "Year",
    y = "Human Capital Index"
  )


```

:::

::: {.column width="32%"}

<div style="font-size:0.65em; line-height:1.15; margin-top: 1.5em;">

**Key Insights**

- All four countries show steady long-run increases in human capital.

- There is no sharp structural break around 2008.

- China more than doubled its human capital index over the period.

</div>
:::
:::

## Revision Summary — Improvements Based on Feedback

::: {.columns}

::: {.column width="60%"}


### <span style="color:#1A73E8;">What I Improved:</span>

- Added clear, concise insight summaries next to each chart.

- Enhanced layout for clearer communication and presentation flow.

:::

::: {.column width="40%"}

![](pedir-feedback.jpg){width=100%}
